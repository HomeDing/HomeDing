<dialog id='addElement'u-is='dialogform'><h2>Add a new Element</h2><div class='u-close'u-action='close'></div><form is='form-json'method='dialog'><div class='form-grid'><label>Type:</label> <select name='type'required><option disabled='disabled'selected='selected'hidden value=''>Select Element...</option></select> <label>ID:</label> <input name='id'required pattern='[0-9a-z]+'placeholder='enter a name ...'></div><div><button u-action='next:configElement'type='submit'style='float:right'>Next</button></div></form></dialog><dialog id='configElement'u-is='dialogform'><h2>Config <span u-text='type'></span>/<span u-text='id'></span></h2><div class='u-close'u-action='close'></div><form is='form-json'method='dialog'><div class='form-grid'></div><div><button u-action='done'type='submit'style='float:right'>save</button></div></form></dialog><dialog id='action'u-is='dialogform'><h2>Config Action...</h2><div class='u-close'u-action='close'></div><form method='dialog'is='form-json'><div class='form-grid'><h4 class='wide'>triggered by:</h4><label>Source:</label><input name='srcId'required> <label>Event:</label><select name='srcEvent'required></select><h4 class='wide'>triggers:</h4><label>Target:</label><select name='target'required></select> <label>Action:</label><select name='action'required></select> <label>Value:</label><input name='value'value='$v'required></div><div><button type='submit'u-action='return'style='float:right'>Save</button></div></form></dialog><script>function lowerKeys(e){const t={};return Object.entries(e).forEach((([e,n])=>{t[e.toLowerCase()]=n})),t}function getDefs(e){const t=e.split("/")[0];return uElements.defs[t]??{}}let d2=document.querySelector("dialog#addElement");d2.addEventListener("open",(e=>{var t=e.detail.form.querySelector("select[name=type]");t&&t.options.length<=1&&Object.keys(uElements.defs).forEach((function(e){var n=createHTMLElement(t,"option",{value:e});n.textContent=e,n.disabled=!uElements.impl.includes(e)}))}));let d3=document.querySelector("dialog#configElement");d3.addEventListener("open",(e=>{const t=lowerKeys(e.detail.data),n=d3.querySelector(".form-grid");function o(e,o,a){createHTMLElement(n,"label").textContent=e+":";const r=createHTMLElement(n,"div",{class:"form-inline"});createHTMLElement(createHTMLElement(r,"label"),"img",{src:o?"/i/start.svg":"/i/no.svg"});const c=createHTMLElement(r,"input",{name:e,style:"width:18ch"});t[e.toLowerCase()]&&(c.value=t[e.toLowerCase()]);let i=createHTMLElement(createHTMLElement(r,"label"),"img",{src:a?"/i/start.svg":"/i/no.svg"});a&&(i.setAttribute("u-action","action"),i.setAttribute("_action",e))}n.innerHTML="",d3.setAttribute("_id",t.type+"/"+t.id);var a=getDefs(t.type);getDefs("element").properties.forEach((e=>o(e,!1,!1))),a?.properties&&a.properties.forEach((e=>o(e,!1,!1))),a?.events&&a.events.forEach((e=>o(e,!0,!1))),a?.actions&&a.actions.forEach((e=>o(e,!1,!0)))})),d3.addEventListener("click",(e=>{const t=e.target;"action"==t.getAttribute("u-action")&&DialogFormClass.openModalForm("action",{srcId:d3.getAttribute("_id"),srcEvent:t.getAttribute("_action")},(function(e){const n=t.getAttribute("_action");d3.querySelector('input[name="'+n+'"]').value=`${e.target}?${e.action}=${e.value}`}))})),d3.addEventListener("submit",(e=>{const t=e.target,n=e.submitter;if(n&&t){"done"===n.getAttribute("u-action")&&changeConfig(d3.getAttribute("_id"),t.getJsonData())}}));let d4=document.querySelector("dialog#action");d4.addEventListener("open",(e=>{const t=e.detail.form,n=e.detail.data,o=t.querySelector("SELECT[name=target]"),a=t.querySelector("SELECT[name=srcEvent]");function r(){const e=t.querySelector("SELECT[name=action]");e.innerHTML="",e.value="",e.disabled=!1,createHTMLElement(e,"option",{disabled:!0,selected:!0,hidden:!0,value:""}).textContent="Select an action...";const n=getDefs(o.value).events;n&&n.forEach((t=>{createHTMLElement(e,"option",{value:t}).textContent=t}))}o.innerHTML="",n.srcEvent?createHTMLElement(a,"option",{value:n.srcEvent}).textContent=n.srcEvent:function(){createHTMLElement(a,"option",{disabled:!0,selected:!0,hidden:!0,value:""}).textContent="Select a event...";const e=getDefs(n.srcId).actions;e&&e.forEach((e=>{createHTMLElement(a,"option",{value:e}).textContent=e}))}(),n.tarId?(createHTMLElement(o,"option",{value:n.tarId}).textContent=n.tarId,o.selected=1,r()):function(){createHTMLElement(o,"option",{disabled:!0,selected:!0,hidden:!0,value:""}).textContent="Select a target...";for(const e in uElements.config)for(const t in uElements.config[e]){const n=e+"/"+t;createHTMLElement(o,"option",{value:n}).textContent=n}}(),o.addEventListener("change",(e=>{r()}))}))</script>