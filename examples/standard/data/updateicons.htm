<!doctype html><html lang='en'><head><meta charset='utf-8'><meta name='viewport'content='width=device-width,initial-scale=1'><title>Update Icon</title></head><body style='width:300px'><h1>Update Icon</h1><table style='width:300px'><tr><td style='width:60px'><img id='icon'></td><td><select id='sel'style='width:10em'><option selected='selected'disabled='disabled'>select...</option></select><progress value='0'max='1'style='width:12em'></progress><div id='info'>&nbsp;</div></td></tr><tr><td colspan='2'style='text-align:right'><button>Start</button></td></tr></table><hr><p style='text-align:right'><a href='/microide.htm'style='float:right;text-decoration:none'>&gt;&gt;&gt;</a></p><script>var repo="https://raw.githubusercontent.com/HomeDing/WebIcons/master/favicons/",eStart=document.querySelector("button"),eBar=document.querySelector("progress"),eInfo=document.querySelector("#info"),eImg=document.querySelector("#icon"),work={status:"0",list:null,files:0,done:0},timer=0,seed="?"+(new Date).valueOf(),iname="";function log(e){eInfo.innerText=e}function next(){work.status="r"}var selObj=document.querySelector("#sel"),list="and,bme680,bulb,button,config,default,dht,digitalin,digitalout,door,home,minus,ntptime,ota,plus,pms,power,radio,remote,rfsend,rotary,schedule,socket,ssdp,switch,time,timer,tool,value,water,wifi".split(",");function doStart(){iname?(log("loading "+iname+" icons"),work.list=["favicon.svg","favicon48.png","favicon192.png","favicon270.png","favicon512.png"],work.files=work.list.length,work.status="r",timer=window.setInterval(step,200)):log("select an icon name...")}function doFile(){work.status="w";var e=work.list.shift();work.done++,eBar.max=work.files,eBar.value=work.done,eInfo.innerText=e,"-"==e[0]?fetch("/"+e.substring(1),{method:"DELETE"}).then(next).catch(next):fetch(repo+iname+"/"+e+seed).catch(next).then((function(e){return e.arrayBuffer()})).then((function(t){var n=new FormData;n.append("file",new Blob([t]),"/"+e),fetch("/",{method:"POST",body:n}).then(next)}))}function step(){"0"==work.status||("r"==work.status?0==work.list.length?work.status="e":doFile():"e"==work.status&&(timer&&(window.clearInterval(timer),log("done")),timer=0))}list.forEach((function(e){var t=document.createElement("option");t.value=t.textContent=e,selObj.appendChild(t)})),selObj.addEventListener("input",(function(e){iname=e.srcElement.value,eImg.src=repo+e.srcElement.value+"/favicon.svg"})),eStart.addEventListener("click",doStart)</script></body></html>