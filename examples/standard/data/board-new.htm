<dialog id='addElement'u-is='dialogform'><h2>Add a new Element</h2><div class='u-close'u-action='close'></div><form method='dialog'><div class='form-grid'><label>Type:</label> <select name='type'value='0'><option disabled='disabled'selected='selected'hidden value='0'>Select Element...</option></select> <label>ID:</label> <input name='id'required pattern='[0-9a-z]+'placeholder='enter a name ...'></div><div><button u-action='next:configElement'type='submit'style='float:right'>Next</button></div></form></dialog><dialog id='configElement'u-is='dialogform'><h2>Config <span u-text='type'></span>/<span u-text='id'></span></h2><div class='u-close'u-action='close'></div><form method='dialog'><div class='form-grid'></div><div><button u-action='done'type='submit'style='float:right'>save</button></div></form></dialog><dialog id='action'u-is='dialogform'><h2>Config <span u-text='srcId'>/t/0</span>.<span u-text='srcAction'>onSome</span></h2><div class='u-close'u-action='close'></div><form method='dialog'><div class='form-grid'><label>Target:</label><select name='target'><option disabled='disabled'selected='selected'hidden>Select target...</option></select> <label>Action:</label><select name='event'disabled='disabled'></select> <label>Value:</label><input name='value'value='$v'></div><div><button u-action='return'style='float:right'>Save</button></div></form></dialog><script>let d2=document.querySelector("dialog#addElement");d2.addEventListener("open",(e=>{var t=e.detail.form.querySelector("select[name=type]");t&&t.options.length<=1&&Object.keys(uElements.defs).forEach((function(e){var n=createHTMLElement(t,"option",{value:e});n.textContent=e,n.disabled=!uElements.impl.includes(e)}))}));let d3=document.querySelector("dialog#configElement");d3.addEventListener("open",(e=>{const t=e.detail.data,n=d3.querySelector(".form-grid");function i(e,i,o){createHTMLElement(n,"label").textContent=e+":";const a=createHTMLElement(n,"div",{class:"form-inline"});createHTMLElement(createHTMLElement(a,"label"),"img",{src:i?"/i/start.svg":"/i/no.svg"});const r=createHTMLElement(a,"input",{name:e,style:"width:18ch"});t[e.toLowerCase()]&&(r.value=t[e.toLowerCase()]);let l=createHTMLElement(createHTMLElement(a,"label"),"img",{src:o?"/i/start.svg":"/i/no.svg"});o&&(l.setAttribute("u-action","action"),l.setAttribute("_action",e))}n.innerHTML="",d3.setAttribute("_id",t.type+"/"+t.id);var o=uElements.defs[t.type];uElements.defs.element.properties.forEach((e=>i(e,!1,!1))),o.properties&&o.properties.forEach((e=>i(e,!1,!1))),o.events&&o.events.forEach((e=>i(e,!0,!1))),o.actions&&o.actions.forEach((e=>i(e,!1,!0)))})),d3.addEventListener("click",(e=>{const t=e.target;"action"==t.getAttribute("u-action")&&DialogFormClass.openModalForm("action",{srcId:d3.getAttribute("_id"),srcAction:t.getAttribute("_action")},(function(e){const n=t.getAttribute("_action");d3.querySelector('input[name="'+n+'"]').value=e.target+"?"+e.event+"="+e.value}))})),d3.addEventListener("submit",(e=>{const t=e.target,n=e.submitter;if(n&&t){if("done"===n.getAttribute("u-action")){const e=new FormData(t),n=Object.fromEntries(e.entries());changeConfig(d3.getAttribute("_id"),n)}}}));let d4=document.querySelector("dialog#action");d4.addEventListener("open",(e=>{const n=e.detail.form,o=n.querySelector("SELECT[name=target]");for(t in o.innerHTML="",createHTMLElement(o,"option",{disabled:"disabled",selected:"selected",hidden:"hidden"}).textContent="Please select target...",uElements.config)for(i in uElements.config[t]){const e=t+"/"+i;createHTMLElement(o,"option",{value:e}).textContent=e}o.addEventListener("change",(e=>{const t=n.querySelector("SELECT[name=event]");t.disabled="",t.innerHTML="",createHTMLElement(t,"option",{disabled:"disabled",selected:"selected",hidden:"hidden"}).textContent="Please select event...";var i=o.value.split("/"),a=uElements.defs[i[0]].events;a&&a.forEach((e=>{createHTMLElement(t,"option",{value:e}).textContent=e}))}))}))</script>